% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/engine.R
\name{sim_eeg_master}
\alias{sim_eeg_master}
\title{Master Controller for Physics-Constrained Tensor EEG Simulation}
\usage{
sim_eeg_master(
  n_trials = 20,
  n_time = 500,
  n_channels = 64,
  n_sources = 10,
  fs = 250,
  snr_neural_db = 5,
  snr_artifact_db = 0,
  drift_power_ratio = 0.5,
  target_freqs = NULL,
  class_labels = NULL,
  seed = NULL,
  verbose = TRUE
)
}
\arguments{
\item{n_trials}{Integer. Total number of trials to simulate.}

\item{n_time}{Integer. Number of time points per trial.}

\item{n_channels}{Integer. Number of EEG channels.}

\item{n_sources}{Integer. Number of latent sources.}

\item{fs}{Numeric. Sampling frequency in Hz.}

\item{snr_neural_db}{Numeric. Target SNR (dB) for the Neural signal relative to the Background brain activity.}

\item{snr_artifact_db}{Numeric. Target SNR (dB) for the Total Neural signal relative to Fast Artifacts (EOG/EMG).}

\item{drift_power_ratio}{Numeric. The ratio of Drift power relative to Neural power.
A value of 0.5 means drift power is half the neural power (in the AC band).}

\item{target_freqs}{Numeric vector (optional). Specific peak frequencies for the VAR(2) background sources.
If NULL, frequencies are randomly drawn from 8-20 Hz.}

\item{class_labels}{Integer vector (optional). A vector of length \code{n_trials} containing 0s and 1s.
If NULL, defaults to alternating 0/1.}

\item{seed}{Integer (optional). If provided, sets RNG seed for reproducible simulation.}

\item{verbose}{Logical. If TRUE, prints simulation progress messages.}
}
\value{
A list containing the simulation results:
\describe{
  \item{\code{data}}{Numeric Array (n_time x n_channels x n_trials). The final simulated EEG tensor.}
  \item{\code{geometry}}{List. Contains sensor coordinates and the base mixing matrix.}
  \item{\code{audit}}{Data frame. Trial-by-trial log of class labels and realized SNR values.}
  \item{\code{labels}}{Integer vector. The class labels used for generation.}
  \item{\code{params}}{List. Metadata including sampling rate and source frequencies.}
}
}
\description{
Orchestrates the entire simulation pipeline to generate a single session of EEG data.
This function integrates:
\enumerate{
  \item \strong{Spatial Geometry:} Generates sensor positions and a Laplacian-smoothed mixing matrix.
  \item \strong{Manifold Dynamics:} Computes trial-specific rotation matrices to simulate non-stationarity.
  \item \strong{Source Activity:} Generates task-related ERPs (Gabor) and background oscillations (VAR2).
  \item \strong{Artifact Injection:} Adds EOG, EMG, and Drift noise with precise SNR control.
  \item \strong{Closed-Loop SNR:} Automatically adjusts component amplitudes to meet target dB levels.
}
}
\details{
The simulation implements a class-dependent logic:
\itemize{
  \item \strong{Class 1:} Characterized by stronger task activation (amplitude 1.5x) and
    weaker background activity (amplitude 0.8x), simulating Event-Related Desynchronization (ERD) or strong ERPs.
  \item \strong{Class 0:} Baseline task activation (amplitude 1.0x) and normal background (1.0x).
}
The Signal-to-Noise Ratio (SNR) is calibrated using "Effective AC Power" (High-Pass > 0.1Hz)
to ensure that high-amplitude low-frequency drifts do not bias the mixing ratios.
}
