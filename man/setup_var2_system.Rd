% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sources.R
\name{setup_var2_system}
\alias{setup_var2_system}
\title{Setup Structured VAR(2) System}
\usage{
setup_var2_system(n_sources, fs, target_freqs)
}
\arguments{
\item{n_sources}{Integer. Number of sources in the VAR model.}

\item{fs}{Numeric. Sampling frequency in Hz.}

\item{target_freqs}{Numeric vector (length = n_sources). The peak frequency for each source.}
}
\value{
A list containing the VAR(2) coefficient matrices:
\item{Phi1}{Matrix (n_sources x n_sources). Lag-1 coefficients.}
\item{Phi2}{Matrix (n_sources x n_sources). Lag-2 coefficients.}
}
\description{
Constructs the coefficient matrices for a Vector Autoregressive model of order 2 (VAR(2)).
This system generates the background brain oscillations (e.g., Alpha, Beta rhythms).
}
\details{
The function designs a stable VAR(2) process where:
\enumerate{
  \item \strong{Diagonal Elements:} Are tuned to generate specific oscillation frequencies
    (\code{target_freqs}) by placing poles on the complex plane with magnitude \code{r_pole} (0.95).
  \item \strong{Off-Diagonal Elements:} Represent functional connectivity (coupling) between sources.
    These are initialized randomly but scaled down iteratively (\code{gamma}) until the
    spectral radius of the companion matrix is < 0.995, ensuring system stability.
}
The process equation is: \eqn{\mathbf{s}(t) = \mathbf{\Phi}_1 \mathbf{s}(t-1) + \mathbf{\Phi}_2 \mathbf{s}(t-2) + \epsilon(t)}
}
