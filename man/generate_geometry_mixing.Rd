% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/physics.R
\name{generate_geometry_mixing}
\alias{generate_geometry_mixing}
\title{Generate Virtual Head Geometry and Mixing Matrix}
\usage{
generate_geometry_mixing(
  n_channels = 64,
  n_sources = 10,
  sigma_geo = 0.3,
  lambda_smooth = 0.5
)
}
\arguments{
\item{n_channels}{Integer. Number of scalp electrodes to simulate (default: 64).}

\item{n_sources}{Integer. Number of latent brain sources (default: 10).}

\item{sigma_geo}{Numeric. The width (sigma) of the initial RBF kernel.
Controls the raw electrical field decay before smoothing.}

\item{lambda_smooth}{Numeric. The regularization parameter for the graph Laplacian.
Higher values create smoother, more biologically plausible topographies
(stronger volume conduction effect).}
}
\value{
A list containing:
\describe{
  \item{\code{coords_sens}}{Matrix (n_channels x 3). XYZ coordinates of sensors on the unit hemisphere.}
  \item{\code{coords_src}}{Matrix (n_sources x 3). XYZ coordinates of sources inside the sphere.}
  \item{\code{A_base}}{Matrix (n_channels x n_sources). The final column-normalized, smoothed mixing matrix.}
  \item{\code{L_sym}}{Matrix (n_channels x n_channels). The normalized graph Laplacian used for the smoothing operator.}
}
}
\description{
Generates a virtual EEG recording setup including 3D sensor coordinates (Fibonacci Grid),
random source locations, and a physically constrained mixing matrix. This function
serves as the static geometric foundation for the simulation.
}
\details{
This function simulates the physics of volume conduction without requiring a
full BEM/FEM head model. It employs a graph-theoretical approach:
\enumerate{
  \item \strong{Sensor Geometry:} A Fibonacci Lattice is used to generate evenly
    distributed sensor positions on the upper hemisphere (\eqn{z \ge 0}).
  \item \strong{Source Geometry:} Sources are randomly placed within a sphere
    of radius 0.8 to ensure they are located "deep" inside the brain volume.
  \item \strong{Physics Constraint:} A raw Radial Basis Function (RBF) lead field
    is smoothed using a Normalized Graph Laplacian to simulate skull conductivity.
    The smoothing operation is defined as Tikhonov regularization:
    \deqn{\mathbf{A}_{smooth} = (\mathbf{I} + \lambda \mathcal{L}_{sym})^{-1} \mathbf{A}_{raw}}
}
The resulting matrix is column-normalized to ensure unit energy per source.
}
